# üß† dl_utils: –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è

–ù–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∑–∞–¥–∞—á —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∑—Ä–µ–Ω–∏—è, —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–º–µ—Ç–∫–æ–π –∏
–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è
–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç –∫–∞–∫ –ø–æ–¥–º–æ–¥—É–ª—å.

## üß© –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏

### üõ†Ô∏è –£—Ç–∏–ª–∏—Ç—ã –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è

- **[utils.py](./docs/utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**: –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
(—Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏)
- **[ipy_utils.py](./docs/ipy_utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è Jupyter Notebooks
- **[ollm_utils.py](./docs/ollm_utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Ollama-—Å–µ—Ä–≤–µ—Ä–∞–º–∏

### üé• –†–∞–±–æ—Ç–∞ —Å –≤–∏–¥–µ–æ

- **[video_utils.py](./docs/video_utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–ó–∞—Ö–≤–∞—Ç, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∏–¥–µ–æ
- **[split-video.sh](./docs/split_video.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–°–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –≤–∏–¥–µ–æ –Ω–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã

### üñºÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑—Ä–µ–Ω–∏–µ (CV)

- **[cv_utils.py](./docs/cv_utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π
- **[alb_utils.py](./docs/alb_utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
- **[ul_utils.py](./docs/ul_utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**: –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è Ultralytics
–ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–∞ –±–∞–∑–µ Albumentations
- **[yolo.py](./docs/yolo.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å YOLO-–º–æ–¥–µ–ª—è–º–∏
- **[seg.py](./docs/seg.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**: –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **[boxmot_utils.py](./docs/boxmot_utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**: –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ç—Ä–µ–∫–µ—Ä–æ–≤ –∏–∑ BoxMOT

### ‚öôÔ∏è –ê–≤—Ç–æ—Ä–∞–∑–º–µ—Ç–∫–∞

- **[samal.py](./docs/samal.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å
[SAM](https://github.com/facebookresearch/segment-anything "–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é")
- **[sam2al.py](./docs/sam2al.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –≤–∏–¥–µ–æ —Å
[SAM2](https://github.com/facebookresearch/sam2 "–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é")
- **[gdinoal.py](./docs/gdinoal.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —Å
[DINO](https://github.com/IDEA-Research/GroundingDINO "–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é")

### üè∑Ô∏è –†–∞–±–æ—Ç–∞ —Å CVAT

- **[cvat.py](./docs/cvat.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**: API –∫–ª–∏–µ–Ω—Ç –¥–ª—è CVAT
- **[cvat_srv.py](./docs/cvat_srv.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –º–µ–∂–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º–∏ CVAT
- **[labels.py](./docs/labels.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–†–∞–±–æ—Ç–∞ —Å –º–µ—Ç–∫–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–∞–±–ª–∏—Ü—ã
[–º–µ—Ç–æ–∫](./docs/labels_template.xlsx.md "–ø–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏") –∏
[—Å—É–ø–µ—Ä–º–µ—Ç–æ–∫](./docs/superlabels_template.xlsx.md "–ø–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")

### ü§ñ –ì–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ

- **[pt_utils.py](./docs/pt_utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–£—Ç–∏–ª–∏—Ç—ã –¥–ª—è PyTorch (—Ä–∞–±–æ—Ç–∞ —Å –º–æ–¥–µ–ª—è–º–∏, –¥–∞–Ω–Ω—ã–º–∏)
- **[tf_utils.py](./docs/tf_utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è TensorFlow/Keras
- **[tfmot_utils.py](./docs/tfmot_utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–ö–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π TensorFlow
- **[ml_utils.py](./docs/ml_utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–û–±—â–∏–µ ML —Ñ—É–Ω–∫—Ü–∏–∏ (–º–µ—Ç—Ä–∏–∫–∏, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö)
- **[onnx_utils.py](./docs/onnx_utils.md "–ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏")**:
–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏ —Ä–∞–±–æ—Ç–∞ —Å ONNX-–º–æ–¥–µ–ª—è–º–∏

<!-- markdownlint-disable MD033 -->
<details>
<summary>üîÑ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–æ–¥—É–ª–µ–π</summary>

```mermaid
graph RL;
    node_0[cvat_srv];
    node_1[ul_utils];
    node_2[tf_utils];
    node_4[yolo];
    node_3[alb_utils];
    node_5[gdinoal];
    node_6[pt_utils];
    node_7[sam2al];
    node_8[ipy_utils];
    node_9[ml_utils];
    node_10[keras_utils];
    node_11[video_utils];
    node_12[cvat];
    node_13[boxmot_utils];
    node_14[ollm_utils];
    node_15[tfmot_utils];
    node_16[utils];
    node_17[seg];
    node_18[cv_utils];
    node_19[samal];
    node_20[labels];
    node_21[onnx_utils];
    %% –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Å—Ç–æ–∫–æ–≤ –Ω–∞ –æ–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ
    subgraph SinkGroup [ ]
        direction LR
        node_6
        node_16
    end
    style SinkGroup fill:none,stroke:none;
    node_0 --> node_12;
    node_1 --> node_12;
    node_2 --> node_3;
    node_3 --> node_16;
    node_4 --> node_12;
    node_4 --> node_9;
    node_5 --> node_6;
    node_5 --> node_12;
    node_7 --> node_6;
    node_7 --> node_17;
    node_8 --> node_12;
    node_9 --> node_16;
    node_10 --> node_16;
    node_11 --> node_16;
    node_12 --> node_11;
    node_12 --> node_18;
    node_13 --> node_18;
    node_14 --> node_16;
    node_15 --> node_10;
    node_17 --> node_12;
    node_18 --> node_16;
    node_19 --> node_6;
    node_19 --> node_12;
    node_20 --> node_16;
    node_21 --> node_9;
```

</details>
<!-- markdownlint-enable MD033 -->

## `>_` Bash-—Å–∫—Ä–∏–ø—Ç—ã

- **rerun.sh**: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞
- **show.sh**: –í—ã–≤–æ–¥ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å—Ç—Ä–æ–∫ –ª–æ–∫—Ñ–∞–π–ª–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **split-video.sh**: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ –Ω–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏

## üê≥ Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ –≤—Å–µ–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.

**–°–∫—Ä–∏–ø—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º:**

- `docker/run.sh`: –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö GPU
- `docker/stop.sh`: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- `docker/restart.sh`: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- `docker/open.sh`: –í—Ö–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- `docker/openroot.sh`: –í—Ö–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–æ–¥ root

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

1. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫–∞–∫ –ø–æ–¥–º–æ–¥—É–ª—å –≤ `main_project/*/dl_utils`, –≥–¥–µ `*` -
–ø–∞–ø–∫–∞ –¥–ª—è –ø–æ–¥–º–æ–¥—É–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `3rdparty`)
1. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–Ω—Ç–∏—Ä—É–µ—Ç –∫–æ—Ä–µ–Ω—å –≥–ª–∞–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –≤ `/workspace`
1. –ü—É—Ç–∏ –≤ –∫–æ–¥–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è `dl_utils`

## ‚ú® –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø—Ä–µ–¥—Ä–∞–∑–º–µ—Ç–∫–∞ (PreAnnotation)

–û—Ç–¥–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –¥–µ—Ç–µ–∫—Ü–∏–∏ (GroundingDINO) –∏–ª–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π
—Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (SAM2) –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ:

- –ù–æ—É—Ç–±—É–∫–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–º —Ä–∞–∑–º–µ—Ç–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ GPU-—É—Å–∫–æ—Ä–µ–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Å–æ–∫/–æ–±—Ä–∞–º–ª—è—é—â–∏—Ö –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤
- –í—ã–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ CVAT (—á–µ—Ä–µ–∑ API)

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

- `PreAnnotation/Dockerfile`: –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
- `run.sh`/`stop.sh`/`restart.sh`: –ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∞–∫–∞/–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –¥–æ–∫–µ—Ä–∞

---
üë®‚Äçüíª–ê–≤—Ç–æ—Ä: **[–ù–∏–∫–∏—Ç–∞](https://disk.yandex.ru/i/2HfPHtSlAJJuyQ
"—Å–º. —Ä–µ–∑—é–º–µ")[–®—É–±–∏–Ω](https://disk.yandex.ru/i/BxSVPalOlTq4GA "my Curriculum vitae")**  
–õ–∏—Ü–µ–Ω–∑–∏—è: [MIT](./LICENSE)
