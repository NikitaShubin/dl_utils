## Модуль [`utils.py`](https://github.com/NikitaShubin/dl_utils/blob/main/utils.py "Перейти к модулю")

Содержит набор утилит общего назначения для работы с:
- изображениями и видео;
- файловой системой;
- параллельными вычислениями;
- различными вспомогательными операциями.

---
## Основные возможности

### Ключевые функции:
- **работа с изображениями/видео**: чтение, запись, обработка, конвертация
- **файловая система**: управление путями, архивами, временными файлами
- **параллельные вычисления**: многопроцессорная обработка данных
- **визуализация**: таблицы, графики, аннотации
- **инструменты для ноутбуков**: управление ядром, очистка вывода
- **утилиты времени**: замер производительности, отложенная инициализация

---

## Основные компоненты

### Классы

| Класс                  | Описание                                            |
|------------------------|-----------------------------------------------------|
| `ImReadBuffer`         | буферизированное чтение кадров из видео/изображений |
| `TimeIt`               | контекст для замера времени выполнения кода         |
| `AnnotateIt`           | декоратор выполнения блоков кода с аннотациями      |
| `DelayedInit`          | отложенная инициализация объектов                   |
| `InternalRandomSeed`   | изоляция состояний генератора случайных чисел       |
| `CircleInd`            | циклический индекс для круговой навигации           |

### Функции

| Категория             | Функции                                                                       |
|-----------------------|-------------------------------------------------------------------------------|
| **изображения/видео** | `autocrop`, `resize_with_pad`, `img_dir2video`, `draw_contrast_text`          |
| **файлы**             | `mkdirs`, `rmpath`, `unzip_dir`, `get_file_list`, `first_existed_path`        |
| **мультипроцессинг**  | `mpmap`, `invzip`, `flatten_list`, `batch_mpmap_func`                         |
| **визуализация**      | `df2img`, `fig2nparray`, `put_text_carefully`, `color_float_hsv_to_uint8_rgb` |
| **ML-утилиты**        | `soft_train_test_split`, `train_val_test_split`                               |
| **прочее**            | `rim2arabic`, `restart_kernel_and_run_all_cells`, `cls`, `isint`              |

---

## Основные методы классов

### `ImReadBuffer`
| Метод        | Назначение                                  |
|--------------|---------------------------------------------|
| `__call__`   | чтение кадра по индексу/пути с кешированием |
| `close`      | освобождение ресурсов                       |
| `bgr2rgb`    | конвертация BGR → RGB                       |

### `TimeIt`
| Метод        | Назначение                           |
|--------------|--------------------------------------|
| `__enter__`  | старт таймера                        |
| `__exit__`   | остановка + вывод времени выполнения |

### `InternalRandomSeed`
| Метод               | Назначение                              |
|---------------------|-----------------------------------------|
| `reset`             | сброс внутреннего состояния генератора  |
| `swap_random_python`| подмена состояния ГПСЧ без side-effects |

---

## Ключевые функции

### Обработка изображений
| Функция              | Назначение                                        |
|----------------------|---------------------------------------------------|
| `autocrop`           | умная обрезка монотонных границ изображения       |
| `resize_with_pad`    | масштабирование с сохранением пропорций + паддинг |
| `overlap_with_alpha` | наложение изображений с поддержкой альфа-канала   |

### Работа с файлами
| Функция              | Назначение                                                     |
|----------------------|----------------------------------------------------------------|
| `unzip_dir`          | пакетная распаковка ZIP-архивов в отдельные поддиректории      |
| `get_file_list`      | рекурсивный поиск файлов по расширениям с поддержкой wildcards |

### Параллелизм
| Функция              | Назначение                                                       |
|----------------------|------------------------------------------------------------------|
| `mpmap`              | параллельный аналог `map()` с прогресс-баром                     |
| `invzip`             | трансформация списка кортежей в структуру аргументов для `mpmap` |