# Модуль `dinoal.py`

## Обзор
Модуль предоставляет интерфейс для работы с моделью Grounding DINO, предназначенной для задач обнаружения объектов с текстовым описанием. Реализует функционал детекции объектов и преобразования результатов в различные форматы.

## Основные возможности

### Ключевые функции
- **Детекция объектов** по текстовым запросам
- **Преобразование результатов** в формат CVAT
- **Визуализация** обнаруженных объектов
- **Гибкая настройка** параметров детекции

## Основные компоненты

### Классы

| Класс | Описание |
|-------|----------|
| `Dino` | Основной класс для работы с моделью Grounding DINO |

### Методы класса Dino

#### Инициализация и настройка
| Метод | Назначение |
|-------|------------|
| `__init__()` | Инициализация модели с параметрами |
| `set_prompt2label()` | Установка соответствия запросов и меток |
| `_parse_prompt2label()` | Парсинг входных запросов |
| `_build_caption()` | Формирование текстового запроса для модели |

#### Основной функционал
| Метод | Назначение |
|-------|------------|
| `_predict()` | Основной метод детекции объектов |
| `img2df()` | Преобразование результатов в DataFrame CVAT |
| `draw()` | Визуализация результатов детекции |
| `show()` | Отображение результатов через matplotlib |

#### Вспомогательные методы
| Метод | Назначение |
|-------|------------|
| `imread()` | Загрузка изображения |
| `_img_preproc()` | Предобработка изображения для модели |

## Детализация функционала

### Параметры инициализации
`python`
`Dino(model_path='../groundingdino_swinb_cogcoor.pth',`
     `box_threshold=0.35,`
     `text_threshold=0.25,`
     `device='auto',`
     `prompt2label={})`
     
### Параметры

- **model_path**: путь к файлу модели
- **box_threshold**: порог уверенности для боксов
- **text_threshold**: порог уверенности для текста
- **device**: устройство для вычислений ('auto', 'cpu', 'cuda')
- **prompt2label**: соответствие текстовых запросов и меток

## Формат входных данных

Поддерживаются как пути к изображениям, так и numpy-массивы

Текстовые запросы могут быть заданы:

- Строкой (один запрос)
- Списком/кортежем/множеством
- Словарем `{запрос: метка}`

## Требования

- Python 3.6+
- GroundingDINO
- OpenCV
- PyTorch
- Matplotlib
- Дополнительные зависимости из `pt_utils.py`, `cvat.py`, `utils.py`
