# Модуль [`dinoal.py`](http://github.com/NikitaShubin/dl_utils/blob/main/dinoal.py "Перейти к модулю")

Предоставляет интерфейс для работы с моделью Grounding DINO, предназначенной для задач обнаружения объектов с текстовым описанием.
Реализует функциональность детекции объектов и преобразования результатов в различные форматы.

---

## Основные возможности

### Ключевые функции:
- **детекция объектов** по текстовым запросам;
- **преобразование результатов** в формат CVAT;
- **визуализация** обнаруженных объектов;
- **гибкая настройка** параметров детекции.

---

## Основные компоненты

### Классы

| Класс  | Описание                                           |
|--------|----------------------------------------------------|
| `Dino` | Основной класс для работы с моделью Grounding DINO |

### Инициализация класса Dino

`python`
`Dino(model_path='../groundingdino_swinb_cogcoor.pth',`
     `box_threshold=0.35,`
     `text_threshold=0.25,`
     `device='auto',`
     `prompt2label={})`

| Параметр       | Назначение                                        |
|----------------|---------------------------------------------------|
| model_path     | путь к файлу модели                               |
| box_threshold  | порог уверенности для боксов                      |
| text_threshold | порог уверенности для текста                      |
| device         | устройство для вычислений ('auto', 'cpu', 'cuda') |
| prompt2label   | соответствие текстовых запросов и меток           |

### Методы класса Dino

#### Основные методы
| Метод      | Назначение                                  |
|------------|---------------------------------------------|
| `img2df()` | преобразование результатов в DataFrame CVAT |
| `draw()`   | визуализация результатов детекции           |
| `show()`   | отображение результатов через matplotlib    |

#### Вспомогательные методы
| Метод      | Назначение           |
|------------|----------------------|
| `imread()` | загрузка изображения |

---

## Формат входных данных

Поддерживаются как пути к изображениям, так и numpy-массивы.

Текстовые запросы могут быть заданы:
- строкой (один запрос);
- списком/кортежем/множеством;
- словарем `{запрос: метка}`.