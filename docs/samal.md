# Модуль `samal.py`

Модуль предоставляет инструменты для автоматической разметки изображений с использованием Segment Anything Model (SAM).
Основное назначение - предварительная разметка данных в CVAT и обработка результатов сегментации.

## Основные компоненты

### 1. Класс `SAM`
Основной класс для работы с Segment Anything Model:

#### Инициализация:
- Поддерживает несколько моделей SAM (ViT-H, ViT-L, ViT-B, ViT-Tiny)
- Автоматическая загрузка весов моделей
- Настройка устройства выполнения (GPU/CPU)
- Поддержка Test Time Augmentation (TTA)

#### Основные методы:
- `img2masks()` - генерация масок для изображения
- `masks2df()` - преобразование масок в CVAT-совместимый DataFrame
- `img2df()` - полный цикл от изображения до разметки

### 2. Обработка масок

#### Классы фильтрации:
- `MasksFilter` - базовый класс для поэлементной обработки масок
- `PrintMasksNum` - вывод количества масок (для отладки)
- `Morphology` - морфологические операции над масками
- `DropByArea` - фильтрация по размеру сегментов
- `DropDuplicates` - удаление дубликатов масок
- `Decompose` - комбинаторное расширение списка сегментов
- `Cutter` - вырезание вложенных сегментов
- `MajorSegment` - выделение главного сегмента
- `FitMasks` - точная подгонка контуров сегментов

#### Функции обработки:
- `isolate_segments` - разделение сложных сегментов
- `drop_shards` - удаление мелких фрагментов
- `fit_segments_in_df` - подгонка контуров в DataFrame

### 3. Вспомогательные функции

#### Преобразования данных:
- `masks2tensor()` - объединение масок в тензор
- `tensor2masks()` - преобразование тензора обратно в маски
- `_build_groups4fuse()` - группировка объектов для слияния

#### Работа с DataFrame:
- Поддержка CVAT-формата
- Обработка видимых/невидимых объектов
- Векторизация масок
- Управление группами объектов