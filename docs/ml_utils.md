# Модуль [`ml_utils.py`](https://github.com/NikitaShubin/dl_utils/blob/main/ml_utils.py "Перейти к модулю")

Предоставляет базовые утилиты для работы с многомерными массивами (тензорами) в задачах машинного обучения.
Основные функции включают преобразования форматов хранения данных и операции с категориальными признаками.

---

## Основные компоненты

### Функции преобразования форматов тензоров

| Функция             | Назначение                                                                                     |
|---------------------|------------------------------------------------------------------------------------------------|
| `nchw2nhwc(tensor)` | преобразование из формата (Batch, Channels, Height, Width) в (Batch, Height, Width, Channels)  |
| `nhwc2nchw(tensor)` | обратное преобразование в формат (Batch, Channels, Height, Width)                              |
| `chw2hwc(tensor)`   | преобразование одиночного изображения из (Channels, Height, Width) в (Height, Width, Channels) |
| `hwc2chw(tensor)`   | обратное преобразование одиночного изображения                                                 |

#### Особенности:
- все функции работают с массивами NumPy;
- поддерживают как 3D (одиночные изображения), так и 4D (батчи) тензоры;
- выполняют перестановку осей без копирования данных.

### One-Hot представление

Функция `ohe(tensor, num_classes)` преобразует целочисленный тензор в one-hot представление:
- вход: тензор с целочисленными значениями от `0` до `num_classes - 1`
- выход: тензор с добавленным последним измерением размерности `num_classes`
- тип выходных данных: `float32`

### Формат хранения каналов

Функция `is_channel_first(shape)` определяет, хранятся ли каналы в тензоре первым измерением:
- анализирует форму тензора (3D или 4D);
- определяет положение канала по минимальному размеру;
- возвращает True (канал первый) или False (канал последний);
- вызывает ValueError, если невозможно определить положение канала.

#### Особенности работы:
- для 4D тензоров анализирует последние 3 измерения;
- принимает как кортежи, так и списки или массивы NumPy;
- проверяет корректность входных данных.