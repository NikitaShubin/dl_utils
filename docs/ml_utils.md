# Модуль `ml_utils.py`

Модуль предоставляет базовые утилиты для работы с многомерными массивами (тензорами) в задачах машинного обучения. Основные функции включают преобразования форматов хранения данных и операции с категориальными признаками.

## Основные компоненты

### 1. Функции преобразования форматов тензоров

#### Транспонирование осей
- `nchw2nhwc(tensor)` - преобразование из формата (Batch, Channels, Height, Width) в (Batch, Height, Width, Channels)
- `nhwc2nchw(tensor)` - обратное преобразование в формат (Batch, Channels, Height, Width)
- `chw2hwc(tensor)` - преобразование одиночного изображения из (Channels, Height, Width) в (Height, Width, Channels)
- `hwc2chw(tensor)` - обратное преобразование одиночного изображения

#### Особенности:
- Все функции работают с массивами NumPy
- Поддерживают как 3D (одиночные изображения), так и 4D (батчи) тензоры
- Выполняют перестановку осей без копирования данных

### 2. Функция One-Hot Encoding

#### `ohe(tensor, num_classes)`
Преобразует целочисленный тензор в one-hot представление:
- Вход: тензор с целочисленными значениями от 0 до num_classes-1
- Выход: тензор с добавленным последним измерением размерности num_classes
- Тип выходных данных: float32

### 3. Определение формата хранения каналов

#### `is_channel_first(shape)`
Определяет, хранятся ли каналы в тензоре первым измерением:
- Анализирует форму тензора (3D или 4D)
- Определяет положение канала по минимальному размеру
- Возвращает True (канал первый) или False (канал последний)
- Вызывает ValueError, если невозможно определить положение канала

#### Особенности работы:
- Для 4D тензоров анализирует последние 3 измерения
- Принимает как кортежи, так и списки или массивы NumPy
- Проверяет корректность входных данных