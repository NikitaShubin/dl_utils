# Модуль [`ipy_utils.py`](https://github.com/NikitaShubin/dl_utils/blob/main/ipy_utils.py "Перейти к модулю")

Предоставляет инструменты для интерактивной работы с изображениями и видео в Jupyter-ноутбуках.
Основная функциональность включает сегментацию изображений, управление элементами интерфейса и отображение мультимедиа.

---

## Основные возможности

### Ключевые функции:
- интерактивная сегментация изображений с поддержкой точек и прямоугольников;
- создание радиокнопок и кнопок с обработчиками событий;
- отображение видео с настройкой размера;
- очистка вывода ячеек Jupyter.

---

## Классы

### Класс `IPYInteractiveSegmentation`

Класс для интерактивной разметки изображений с поддержкой точек, масок и прямоугольников.

| Метод         | Назначение                                                                 |
|---------------|----------------------------------------------------------------------------|
| `show(img)`   | Отображает изображение с возможностью добавления/удаления точек. Поддерживает:<br>- Зум и панорамирование<br>- Маркеры: `'p'` (маска, чёрный), `'s'` (прямоугольник, синий), `'o'` (включение, зелёный), `'x'` (исключение, красный), `'X'` (очистка, белый) |
| `on_click()`  | Обрабатывает изменения точек. Строит маски через `points2masks` (если задана) и рисует прямоугольник. |
| `clear()`     | Очищает все точки и обновляет изображение.                                |

#### Параметры инициализации:
- `img`: изображение для сегментации (опционально);
- `points2masks`: функция преобразования точек в маски;
- `init_msk_points`, `init_box_points`, `init_pos_points`, `init_neg_points`: начальные точки для масок, прямоугольников, включений и исключений.

### Класс `IPYRadioButtons`

Класс для создания группы радиокнопок с обработчиком выбора.

| Метод       | Назначение                                                      |
|-------------|-----------------------------------------------------------------|
| `show()`    | отображает радиокнопки. Вызывает `setter` при изменении выбора. |

#### Параметры инициализации:
- `options`: список вариантов (например, `["Вариант 1", "Вариант 2"]`);
- `description`: текст-описание (по умолчанию `' '`);
- `setter`: функция-обработчик выбора (например, логика фильтрации).

### Класс `IPYButton`

Класс для создания интерактивной кнопки с действием.

| Метод           | Назначение                                                                 |
|-----------------|----------------------------------------------------------------------------|
| `show()`        | Отображает кнопку и поле для вывода.                                       |
| `preprocess(func)` | Декоратор для очистки вывода перед выполнением действия (если `use_cls=True`). |

#### Параметры инициализации:
- `description`: текст на кнопке (по умолчанию `' '`);
- `action`: функция, вызываемая при нажатии;
- `use_cls`: флаг очистки вывода перед выполнением `action` (по умолчанию `True`).

---

## Вспомогательные функции
| Функция                | Назначение                              |
|------------------------|-----------------------------------------|
| `cls()`                | очистка вывода текущей ячейки           |
| `show_video()`         | отображение видео из файла              |

### `show_video(file, clear=True, size=None)`
Отображает видео из файла в Jupyter-ноутбуке.

#### Параметры
| Параметр | Назначение                                                                                                                                                                  |
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `file`   | путь к видеофайлу                                                                                                                                                           |
| `clear`  | очистка вывода перед отображением (по умолчанию `True`)                                                                                                                     |
| `size`   | размер видео; <br/> форматы: <br/> - число (например, `300`) — высота, ширина вычисляется автоматически); <br/> - список/кортеж (например, `[400, 600]` — высота и ширина). |