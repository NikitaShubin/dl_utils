# Модуль `ipy_utils.py`

## Общее описание
Модуль `ipy_utils.py` предоставляет инструменты для интерактивной работы с изображениями и видео в Jupyter-ноутбуках. Основные функции включают интерактивную сегментацию изображений, управление радиокнопками и кнопками, а также отображение видео.

---

## Классы и функции

### 1. `IPYInteractiveSegmentation`
Класс для интерактивной сегментации изображений в Jupyter-ноутбуке.

#### Методы:
- **`show(img)`**:
  Отображает изображение `img` с возможностью интерактивного добавления/удаления точек для сегментации.
  Поддерживает зум и панорамирование.
  Точки разделяются на категории:
  - `mask` (маска) — маркер `'p'`, чёрный цвет.
  - `box` (прямоугольник) — маркер `'s'`, синий цвет.
  - `include` (включение) — маркер `'o'`, зелёный цвет.
  - `exclude` (исключение) — маркер `'x'`, красный цвет.
  - `clear` (очистка) — маркер `'X'`, белый цвет.

- **`on_click()`**:
  Обрабатывает изменения в наборе точек.
  Если задана функция `points2masks`, строит маски на основе текущих точек и отображает их на изображении.
  Также рисует прямоугольник, если заданы точки для `box`.

- **`clear()`**:
  Очищает все точки и обновляет изображение.

#### Параметры инициализации:
- `img`: изображение для сегментации (опционально).
- `points2masks`: функция для построения масок по точкам (опционально).
- `init_msk_points`, `init_box_points`, `init_pos_points`, `init_neg_points`: начальные точки для соответствующих категорий.

---

### 2. `IPYRadioButtons`
Класс для создания радиокнопок в Jupyter-ноутбуке.

#### Методы:
- **`show()`**:
  Отображает радиокнопки. Если задан `setter`, вызывает его при изменении выбора.

#### Параметры инициализации:
- `options`: список вариантов для выбора.
- `description`: описание (по умолчанию `' '`).
- `setter`: функция-обработчик изменения выбора (опционально).

---

### 3. `IPYButton`
Класс для создания интерактивной кнопки.

#### Методы:
- **`show()`**:
  Отображает кнопку и поле для вывода.
- **`preprocess(func)`**:
  Декоратор для очистки вывода перед выполнением действия (если `use_cls=True`).

#### Параметры инициализации:
- `description`: текст на кнопке (по умолчанию `' '`).
- `action`: функция, вызываемая при нажатии (опционально).
- `use_cls`: флаг очистки вывода перед действием (по умолчанию `True`).

---

### 4. Вспомогательные функции
- **`cls()`**:
  Очищает вывод текущей ячейки Jupyter-ноутбука.
- **`show_video(file, clear=True, size=None)`**:
  Отображает видео из файла `file`.
  Параметры:
  - `clear`: очистка вывода перед отображением (по умолчанию `True`).
  - `size`: размер видео (высота и ширина). Может быть задан как число, список или кортеж.

---

## Зависимости
Модуль использует следующие библиотеки:
- `numpy` — работа с массивами.
- `matplotlib` — визуализация изображений.
- `mpl_point_clicker` — обработка кликов на изображении.
- `mpl_interactions` — зум и панорамирование.
- `IPython` — интеграция с Jupyter-ноутбуками.
- `ipywidgets` — создание интерактивных элементов.
- `cv_utils` — работа с масками (утилиты OpenCV).
- `cvat` — обработка точек и прямоугольников.

## Примечания

- Для работы модуля требуется **Jupyter-ноутбук** с поддержкой интерактивных виджетов.
- Функция `points2masks` должна:
  - Принимать точки в качестве входных данных
  - Возвращать маски в формате, совместимом с `Mask` из модуля `cv_utils`
- В функции `show_video` параметр размера можно указать:
  - Как одно число (тогда будет использовано как высота, а ширина рассчитается автоматически)
  - Как кортеж/список (высота, ширина) для точного задания размеров
