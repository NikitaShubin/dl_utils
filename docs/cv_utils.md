## Модуль [`cv_utils.py`](https://github.com/NikitaShubin/dl_utils/blob/develop/cv_utils.py "Перейти к модулю")

Предоставляет инструменты для работы с бинарными и полутоновыми масками в задачах компьютерного зрения.
Основные функции реализованы в классе `Mask`, который поддерживает различные операции с масками и их визуализацию.

---
## Основные возможности

### Ключевые функции:
- создание и преобразование масок;
- морфологические операции (дилатация, эрозия, закрытие, открытие);
- расчет метрик сравнения масок (IoU, Jaccard, Dice, Overlap);
- визуализация масок и создание анимаций;
- построение матриц связности между наборами масок.

---

## Основные компоненты

### Классы

| Класс  | Описание                                            |
|--------|-----------------------------------------------------|
| `Mask` | класс для работы с бинарными и полутоновыми масками |

### Функции

| Функция                                    | Назначение                                |
|--------------------------------------------|-------------------------------------------|
| `float2uin8()`                             | конвертация изображений из float в uint8  |
| `video2gif()`                              | создание GIF из последовательности кадров |
| `build_masks_IoU_matrix()`                 | построение матрицы пересечений масок      |
| `build_masks_JaccardDiceOverlap_matrixs()` | построение матриц нескольких метрик       |

## Основные методы класса Mask

### Операции с масками
| Операция     | Назначение                   |
|--------------|------------------------------|
| `astype()`   | изменение типа данных        |
| `to_image()` | конвертация в изображение    |
| `rot90()`    | поворот маски                |
| Отражения:   |                              |
| `flip()`     | отражение вдоль заданной оси | 
| `fliplr()`   | отражение вдоль горизонтали  |
| `flipud()`   | отражение вдоль вертикали    |

### Морфологические операции
| Операция | Назначение |
|----------|------------|
| `*`      | дилатация  |
| `/`      | эрозия     |
| `**`     | закрытие   |
| `//`     | открытие   |
| `~`      | инверсия   |

### Метрики сравнения
| Метрика                       | Назначение             |
|-------------------------------|------------------------|
| `Jaccard_with()`/`IoU_with()` | индекс Жаккара         |
| `Dice_with()`                 | коэффициент Дайса      |
| `Overlap_with()`              | коэффициент перекрытия |
| `is_rect_intersection_with()` | проверка пересечений   |

### Визуализация
| Функция  | Назначение                   |
|----------|------------------------------|
| `draw()` | отрисовка на изображении     |
| `show()` | отображение через matplotlib |

## Статические методы
| Метод                    | Назначение                           |
|--------------------------|--------------------------------------|
| `from_COCO_annotation()` | создание из аннотации COCO           |
| `make_kernel()`          | создание структурного элемента       |
| `make_scaled_kernel()`   | масштабированный структурный элемент |