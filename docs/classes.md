# Модуль `classes.py`

## Общее описание
Модуль предоставляет функционал для работы с метками классов и суперклассов, хранящимися в Excel-файлах. Основное назначение - конвертация между различными системами обозначений классов и организация иерархических связей между ними.

## Основные компоненты

### 1. Вспомогательные функции
#### Чтение данных:
- `read_classes2df()` - загрузка и предобработка файла с классами:
  - Удаление пустых столбцов
  - Очистка строковых значений
  - Установка первого столбца как индекса
  - Удаление пустых строк

- `read_superclasses2df()` - загрузка файла с суперклассами:
  - Заполнение пропущенных значений
  - Нормализация номеров суперклассов
  - Проверка целостности данных

#### Обработка данных:
- `classes2tree()` - построение иерархического дерева классов:
  - Поддержка римских и арабских номеров
  - Разделение на группы и подклассы
  - Хранение меток CVAT и UUID

- `fix_string()` - унификация строковых значений:
  - Замена специальных пробелов
  - Удаление лишних пробелов

### 2. Функции создания словарей
- `make_label2class_meaning_dicts()` - создание словарей перевода меток:
  - `cvat_label2class_meaning` - для меток CVAT
  - `gg_uuid2class_meaning` - для UUID меток
  - Проверка на уникальность меток

- `make_yolo_label2superclass_meaning()` - словарь номеров YOLO → суперклассы
- `make_class_meaning2superclass_meaning()` - словарь классов → суперклассы

### 3. Класс LabelsConvertor
Основной класс для работы с метками классов и суперклассов.

#### Инициализация:
- Автоматический поиск файлов классов
- Загрузка и предобработка данных
- Построение всех необходимых словарей
- Инициализация счетчиков классов

#### Основные методы:
- `any_label2meaning()` - конвертация любой метки в читаемое название
- `__call__()` - конвертация метки в номер суперкласса
- `apply2df()` - применение конвертации к DataFrame
- `init_df_counter()` - создание счетчиков классов

#### Хранимые данные:
- Иерархия классов (tree)
- Множество словарей для конвертации
- Списки уникальных значений
- Счетчики встречаемости

### 4. Дополнительные функции
- `checkout_labels_in_tasks()` - поиск неподдерживаемых меток
- `apply_labels_convertor2tasks()` - пакетная конвертация меток

## Особенности реализации

1. **Гибкость работы с данными**:
   - Поддержка нескольких систем обозначений (CVAT, UUID, YOLO)
   - Автоматическое заполнение пропущенных значений
   - Обработка римских и арабских номеров

2. **Контроль качества данных**:
   - Проверка уникальности меток
   - Валидация структуры данных
   - Обработка исключительных ситуаций

3. **Производительность**:
   - Предварительное построение словарей
   - Векторизованные операции с DataFrame
   - Оптимизированные структуры данных

4. **Расширяемость**:
   - Четкое разделение логики
   - Универсальные интерфейсы
   - Поддержка различных форматов входных данных

## Форматы данных
- **Входные данные**: Excel-файлы с жестко заданной структурой
- **Выходные данные**: 
  - Словари конвертации
  - DataFrame с метаинформацией
  - Иерархические структуры

## Обработка ошибок
- Проверка на дублирование меток
- Обработка отсутствующих значений
- Контроль целостности иерархий
- Явные сообщения об ошибках
